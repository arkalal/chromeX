/*! For license information please see content.js.LICENSE.txt */
(()=>{function e(){var n,r,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function l(e,o,a,i){var l=o&&o.prototype instanceof s?o:s,d=Object.create(l.prototype);return t(d,"_invoke",function(e,t,o){var a,i,l,s=0,d=o||[],p=!1,u={p:0,n:0,v:n,a:f,f:f.bind(n,4),d:function(e,t){return a=e,i=0,l=n,u.n=t,c}};function f(e,t){for(i=e,l=t,r=0;!p&&s&&!o&&r<d.length;r++){var o,a=d[r],f=u.p,m=a[2];e>3?(o=m===t)&&(l=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=n):a[0]<=f&&((o=e<2&&f<a[1])?(i=0,u.v=t,u.n=a[1]):f<m&&(o=e<3||a[0]>t||t>m)&&(a[4]=e,a[5]=t,u.n=m,i=0))}if(o||e>1)return c;throw p=!0,t}return function(o,d,m){if(s>1)throw TypeError("Generator is already running");for(p&&1===d&&f(d,m),i=d,l=m;(r=i<2?n:l)||!p;){a||(i?i<3?(i>1&&(u.n=-1),f(i,l)):u.n=l:u.v=l);try{if(s=2,a){if(i||(o="next"),r=a[o]){if(!(r=r.call(a,l)))throw TypeError("iterator result is not an object");if(!r.done)return r;l=r.value,i<2&&(i=0)}else 1===i&&(r=a.return)&&r.call(a),i<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=n}else if((r=(p=u.n<0)?l:e.call(t,u))!==c)break}catch(e){a=n,i=1,l=e}finally{s=1}}return{value:r,done:p}}}(e,a,i),!0),d}var c={};function s(){}function d(){}function p(){}r=Object.getPrototypeOf;var u=[][a]?r(r([][a]())):(t(r={},a,function(){return this}),r),f=p.prototype=s.prototype=Object.create(u);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,t(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return d.prototype=p,t(f,"constructor",p),t(p,"constructor",d),d.displayName="GeneratorFunction",t(p,i,"GeneratorFunction"),t(f),t(f,i,"Generator"),t(f,a,function(){return this}),t(f,"toString",function(){return"[object Generator]"}),(e=function(){return{w:l,m}})()}function t(e,n,r,o){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}t=function(e,n,r,o){if(n)a?a(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r;else{var i=function(n,r){t(e,n,function(e){return this._invoke(n,r,e)})};i("next",0),i("throw",1),i("return",2)}},t(e,n,r,o)}function n(e,t,n,r,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function r(e){return function(){var t=this,r=arguments;return new Promise(function(o,a){var i=e.apply(t,r);function l(e){n(i,o,a,l,c,"next",e)}function c(e){n(i,o,a,l,c,"throw",e)}l(void 0)})}}function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){c=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw i}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=!1,l=null;function c(e,t){var n=e.parentElement;if(n){var r=document.createElement("div");r.className="T-I J-J5-Ji T-I-atl ai-write-button",r.style.cssText="\n    margin-left: 8px;\n    background-color: #4F46E5;\n    color: white;\n    border-radius: 4px;\n    cursor: pointer;\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    height: 36px;\n    min-width: 42px;\n    padding: 0 16px;\n    font-weight: 600;\n    font-size: 14px;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n    position: relative;\n    z-index: 1;\n  ",r.addEventListener("mouseover",function(){r.style.backgroundColor="#4338ca",r.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.15)"}),r.addEventListener("mouseout",function(){r.style.backgroundColor="#4F46E5",r.style.boxShadow="0 1px 3px rgba(0, 0, 0, 0.1)"});var a=document.createElement("span");a.className="T-I-ax7 ai-button-text",a.textContent="AI",a.style.fontSize="14px",a.style.fontWeight="600",r.appendChild(a);var i=n.closest("tr");if(i){var l=i.querySelector("td");if(l){var c=Array.from(l.querySelectorAll(".T-I")).find(function(t){return("true"===t.getAttribute("aria-haspopup")||"More send options"===t.getAttribute("data-tooltip"))&&t!==e});if(c){var p=c.closest("td");p?p.parentNode.insertBefore(r,p.nextSibling):c.parentNode.insertBefore(r,c.nextSibling)}else e.parentNode.insertBefore(r,e.nextSibling)}else n.insertBefore(r,e.nextSibling)}else n.insertBefore(r,e.nextSibling);return r.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),function(e){var t=document.getElementById("gmail-ai-popup");t&&t.remove();var n=document.createElement("div");n.id="gmail-ai-popup",n.className="gmail-ai-popup",n.style.cssText="\n    position: fixed;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    width: 600px;\n    max-width: 90vw;\n    max-height: 80vh;\n    background: #fff;\n    border-radius: 8px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n    z-index: 9999;\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n  ";var r=document.createElement("div");r.className="popup-header",r.style.cssText="\n    padding: 16px;\n    border-bottom: 1px solid #E5E7EB;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    background-color: #4F46E5;\n    color: white;\n  ";var a=document.createElement("h3");a.textContent="Write with AI",a.style.cssText="\n    margin: 0;\n    font-size: 18px;\n    font-weight: 500;\n  ";var i=document.createElement("button");i.innerHTML="&times;",i.style.cssText="\n    background: transparent;\n    border: none;\n    font-size: 24px;\n    cursor: pointer;\n    color: white;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 30px;\n    height: 30px;\n  ",i.onclick=function(){return n.remove()},r.appendChild(a),r.appendChild(i),n.appendChild(r);var l=document.createElement("div");l.className="popup-content",l.style.cssText="\n    padding: 16px;\n    flex-grow: 1;\n    display: flex;\n    flex-direction: column;\n    gap: 16px;\n    overflow-y: auto;\n  ";var c=document.createElement("div");c.className="prompt-section",c.style.cssText="\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n  ";var p=document.createElement("label");p.textContent="What do you want to write?",p.style.cssText="\n    font-size: 14px;\n    color: #111827;\n    font-weight: 500;\n  ";var u=document.createElement("textarea");u.className="prompt-input",u.placeholder="Example: Write a professional email to schedule a meeting with the marketing team...",u.style.cssText="\n    padding: 12px;\n    border: 1px solid #E5E7EB;\n    border-radius: 4px;\n    min-height: 100px;\n    font-size: 14px;\n    resize: vertical;\n  ",c.appendChild(p),c.appendChild(u);var f=document.createElement("div");f.className="result-section",f.style.display="none",f.style.cssText="\n    display: none;\n    flex-direction: column;\n    gap: 8px;\n  ";var m=document.createElement("div");m.className="result-header",m.style.cssText="\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n  ";var b=document.createElement("label");b.textContent="Generated Email",b.style.cssText="\n    font-size: 14px;\n    color: #111827;\n    font-weight: 500;\n  ",m.appendChild(b);var v=document.createElement("div");v.className="result-content",v.style.cssText="\n    padding: 12px;\n    border: 1px solid #E5E7EB;\n    border-radius: 4px;\n    min-height: 200px;\n    font-size: 14px;\n    background: #F9FAFB;\n    white-space: pre-wrap;\n    overflow-y: auto;\n  ";var h=document.createElement("div");h.className="subject-section",h.style.cssText="\n    display: none;\n    flex-direction: column;\n    gap: 8px;\n  ";var g=document.createElement("label");g.textContent="Email Subject",g.style.cssText="\n    font-size: 14px;\n    color: #111827;\n    font-weight: 500;\n  ";var x=document.createElement("input");x.className="subject-input",x.type="text",x.style.cssText="\n    padding: 12px;\n    border: 1px solid #E5E7EB;\n    border-radius: 4px;\n    font-size: 14px;\n  ",h.appendChild(g),h.appendChild(x),f.appendChild(m),f.appendChild(v),l.appendChild(c),l.appendChild(h),l.appendChild(f);var y=document.createElement("div");y.className="popup-footer",y.style.cssText="\n    padding: 16px;\n    border-top: 1px solid #E5E7EB;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n  ";var E=document.createElement("select");E.className="tone-selector",E.style.cssText="\n    padding: 8px;\n    border: 1px solid #E5E7EB;\n    border-radius: 4px;\n    font-size: 14px;\n  ",["Professional","Friendly","Formal","Casual","Persuasive"].forEach(function(e){var t=document.createElement("option");t.value=e.toLowerCase(),t.textContent=e,E.appendChild(t)});var w=document.createElement("div");w.className="action-buttons",w.style.cssText="\n    display: flex;\n    gap: 8px;\n  ";var T=document.createElement("button");T.className="generate-button",T.textContent="Write Email",T.style.cssText="\n    padding: 8px 16px;\n    background-color: #4F46E5;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    font-size: 14px;\n    font-weight: 500;\n    cursor: pointer;\n  ";var C=document.createElement("button");C.className="apply-button",C.textContent="Apply",C.style.cssText="\n    padding: 8px 16px;\n    background-color: #F97316;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    font-size: 14px;\n    font-weight: 500;\n    cursor: pointer;\n    display: none;\n  ";var A=document.createElement("button");A.className="cancel-button",A.textContent="Cancel",A.style.cssText="\n    padding: 8px 16px;\n    background-color: transparent;\n    color: #6B7280;\n    border: 1px solid #E5E7EB;\n    border-radius: 4px;\n    font-size: 14px;\n    font-weight: 500;\n    cursor: pointer;\n  ",A.onclick=function(){return n.remove()},y.appendChild(E),w.appendChild(A),w.appendChild(T),w.appendChild(C),y.appendChild(w),n.appendChild(l),n.appendChild(y),T.addEventListener("click",function(){var t=u.value.trim();t?function(e,t,n,r,o,a,i,l){s.apply(this,arguments)}(t,E.value,v,x,e,C,h,f):alert("Please enter a prompt first")}),C.addEventListener("click",function(){var t=[];v.querySelectorAll("p").forEach(function(e){var n,r="",a=o(e.childNodes);try{for(a.s();!(n=a.n()).done;){var i=n.value;i.nodeType===Node.TEXT_NODE?r+=i.textContent:"BR"===i.nodeName&&(r+="\n")}}catch(e){a.e(e)}finally{a.f()}t.push(r)});var r=t.join("\n\n");!function(e,t,n){d.apply(this,arguments)}(e,r,x.value),n.remove()}),document.body.appendChild(n),setTimeout(function(){return u.focus()},10)}(t)}),r}}function s(){return(s=r(e().m(function t(n,r,a,c,s,d,p,u){var f,m,b,v,h,g,x,y,E,w,T,C,A,S,k,j,N,L,G,z,H,M,O,B,I,P,R,q,F,D,J,W,_,U,K,X,Y;return e().w(function(e){for(;;)switch(e.n){case 0:if(!i){e.n=1;break}return e.a(2);case 1:if(n&&""!==n.trim()){e.n=2;break}return a.innerHTML='<div class="error">Error: Please enter a prompt first</div>',e.a(2);case 2:return a.innerHTML='<div class="loading">Generating your email...</div>',a.style.opacity="0.7",u.style.display="flex",e.p=3,i=!0,e.p=4,e.n=5,chrome.runtime.sendMessage({action:"getOpenAIKey"});case 5:if(m=e.v,f=m.apiKey){e.n=6;break}return a.innerHTML='<div class="error">OpenAI API key not configured. Please contact the administrator.</div>',i=!1,e.a(2);case 6:e.n=8;break;case 7:return e.p=7,_=e.v,console.error("Error getting API key:",_),a.innerHTML='<div class="error">Could not access API key. Please try again.</div>',i=!1,e.a(2);case 8:return l=new AbortController,b=l.signal,v=r&&"professional"!==r?"in a ".concat(r," tone"):"","Write a professional email ".concat(v," based on this instruction: ").concat(n,". Make sure to include a relevant subject line as shown in the format instructions."),console.log("Sending request to OpenAI:",{tone:r,promptLength:n.length}),h={model:"gpt-4o",messages:[{role:"system",content:"You are an AI writing assistant helping with email composition."},{role:"user",content:"".concat(r?"Write in a ".concat(r," tone: "):"").concat(n)}],stream:!0,temperature:.7},e.n=9,fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(f)},body:JSON.stringify(h),signal:b});case 9:if((g=e.v).ok){e.n=14;break}return x="Error calling OpenAI API",e.p=10,e.n=11,g.json();case 11:E=e.v,x=(null===(y=E.error)||void 0===y?void 0:y.message)||x,e.n=13;break;case 12:e.p=12,U=e.v,console.error("Error parsing error response:",U);case 13:throw new Error(x);case 14:w=g.body.getReader(),T=new TextDecoder("utf-8"),C="",A="",a.innerHTML="",S=!1,k="",j=!1;case 15:return e.n=16,w.read();case 16:if(N=e.v,L=N.done,G=N.value,!L){e.n=17;break}return e.a(3,31);case 17:z=T.decode(G),H=z.split("\n"),M=o(H),e.p=18,M.s();case 19:if((O=M.n()).done){e.n=27;break}if(!(B=O.value).startsWith("data: ")||"data: [DONE]"===B){e.n=26;break}if(e.p=20,P=JSON.parse(B.substring(6)),!(R=(null===(I=P.choices[0])||void 0===I||null===(I=I.delta)||void 0===I?void 0:I.content)||"")){e.n=24;break}if(A||j){e.n=23;break}if(!R.includes("SUBJECT:")){e.n=21;break}return S=!0,k=R.split("SUBJECT:")[1]||"",e.a(3,26);case 21:if(!S){e.n=23;break}if(!R.includes("\n")){e.n=22;break}q=R.split("\n"),k+=q[0],A=k.trim(),c.value=A,p.style.display="flex",(F=q.slice(1).join("\n")).trim()&&(C=F),S=!1,j=!0,e.n=23;break;case 22:return k+=R,e.a(3,26);case 23:S||(j?C+=R:R.trim()&&!R.trim().startsWith("SUBJECT:")&&(j=!0,C+=R)),D=C.replace(/\n{3,}/g,"\n\n"),a.innerHTML="",(J=D.split(/\n\n/)).forEach(function(e){if(e.trim()){var t=document.createElement("p");if(t.style.cssText='color: rgb(32, 33, 36); font-family: "Google Sans", Roboto, RobotoDraft, Helvetica, Arial, sans-serif; font-size: 14px; white-space-collapse: preserve; margin: 0px 0px 12px;',e.includes("\n")){var n=e.split("\n").filter(function(e){return""!==e});if(n.length>0){t.textContent=n[0];for(var r=1;r<n.length;r++)t.appendChild(document.createElement("br")),t.appendChild(document.createTextNode(n[r]))}}else t.textContent=e;a.appendChild(t)}}),J.length>0&&((W=document.createElement("p")).style.cssText='color: rgb(32, 33, 36); font-family: "Google Sans", Roboto, RobotoDraft, Helvetica, Arial, sans-serif; font-size: 14px; white-space-collapse: preserve; margin: 0;',W.innerHTML="<br>",a.appendChild(W));case 24:e.n=26;break;case 25:e.p=25,K=e.v,console.error("Error parsing JSON from stream:",K);case 26:e.n=19;break;case 27:e.n=29;break;case 28:e.p=28,X=e.v,M.e(X);case 29:return e.p=29,M.f(),e.f(29);case 30:e.n=15;break;case 31:d.style.display="block",a.style.opacity="1",e.n=33;break;case 32:e.p=32,"AbortError"===(Y=e.v).name?a.innerHTML='<div class="cancelled">Generation cancelled.</div>':(console.error("Error generating content:",Y),a.innerHTML='<div class="error">Error: '.concat(Y.message,"</div>"));case 33:return e.p=33,i=!1,l=null,e.f(33);case 34:return e.a(2)}},t,null,[[20,25],[18,28,29,30],[10,12],[4,7],[3,32,33,34]])}))).apply(this,arguments)}function d(){return(d=r(e().m(function t(n,r,o){var a,i,l,c,s,d;return e().w(function(e){for(;;)switch(e.n){case 0:if(n&&r){e.n=1;break}return e.a(2);case 1:try{a=o?o.trim():"",i=r,!a&&r&&(l=r.split(/\n\s*\n/)).length>=2&&(c=l[0].trim()).length<=100&&!c.includes("\n")&&l.length>1&&(a=c,i=l.slice(1).join("\n\n")),a&&((s=document.querySelector('input[name="subjectbox"]')||document.querySelector("input.aoT")||document.querySelector('input[aria-label="Subject"]')||document.querySelector('form.bAs input[placeholder="Subject"]')||Array.from(document.querySelectorAll('input[type="text"]')).find(function(e){return"Subject"===e.placeholder||"Subject"===e.getAttribute("aria-label")||e.classList.contains("aoT")}))?(s.value=a,s.focus(),s.dispatchEvent(new Event("input",{bubbles:!0})),s.dispatchEvent(new Event("change",{bubbles:!0})),s.dispatchEvent(new Event("blur",{bubbles:!0})),console.log("Successfully inserted subject into Gmail subject field:",a)):(console.warn("Gmail subject field not found, will include subject in body"),a!==o&&(i=a+"\n\n"+i))),d=i.trim(),p(n,d),n.dispatchEvent(new Event("input",{bubbles:!0,composed:!0})),n.dispatchEvent(new Event("change",{bubbles:!0,composed:!0})),n.dispatchEvent(new CustomEvent("gmail-compose-updated",{bubbles:!0}))}catch(e){console.error("Error applying content to Gmail:",e);try{document.execCommand("insertText",!1,r)}catch(e){console.error("ExecCommand fallback failed:",e)}}case 2:return e.a(2)}},t)}))).apply(this,arguments)}function p(e,t){e.focus();try{""===e.innerHTML.trim()||"<br>"===e.innerHTML.trim()||e.innerHTML.trim(),e.innerHTML="";var n=t.replace(/\r\n|\r/g,"\n").split(/\n\n+/),r=document.createDocumentFragment();n.forEach(function(e,t){if(e.trim()){var n=document.createElement("p");if(n.style.cssText='color: rgb(32, 33, 36); font-family: "Google Sans", Roboto, RobotoDraft, Helvetica, Arial, sans-serif; font-size: 14px; white-space-collapse: preserve; margin: 0px 0px 12px;',e.includes("\n")){var o=e.split("\n").filter(function(e){return""!==e});if(o.length>0){n.textContent=o[0];for(var a=1;a<o.length;a++)n.appendChild(document.createElement("br")),n.appendChild(document.createTextNode(o[a]));r.appendChild(n)}}else e.trim()&&(n.textContent=e,r.appendChild(n))}}),e.appendChild(r);var o=document.createElement("p");o.style.cssText='color: rgb(32, 33, 36); font-family: "Google Sans", Roboto, RobotoDraft, Helvetica, Arial, sans-serif; font-size: 14px; white-space-collapse: preserve; margin: 0px 0px 0px;',o.innerHTML="<br>",e.appendChild(o),["input","change"].forEach(function(t){e.dispatchEvent(new Event(t,{bubbles:!0,composed:!0}))}),["focus","blur"].forEach(function(t){e.dispatchEvent(new Event(t,{bubbles:!0}))}),["keyup","compositionend","textInput"].forEach(function(t){e.dispatchEvent(new Event(t,{bubbles:!0,composed:!0}))}),e.dispatchEvent(new CustomEvent("gmail-content-updated",{bubbles:!0})),e.dispatchEvent(new CustomEvent("input-change",{bubbles:!0}));var a=window.getSelection(),i=document.createRange();i.selectNodeContents(e),i.collapse(!1),a.removeAllRanges(),a.addRange(i)}catch(n){console.error("Error inserting into Gmail compose box:",n);try{var l=function(e){return e.replace(/\r\n|\r/g,"\n").split(/\n\n+/).map(function(e){if(!e.trim())return"";var t=e.includes("\n")?e.split("\n").join("<br>"):e;return"<p style=\"color: rgb(32, 33, 36); font-family: 'Google Sans', Roboto, RobotoDraft, Helvetica, Arial, sans-serif; font-size: 14px; white-space-collapse: preserve; margin: 0px 0px 12px;\">".concat(t,"</p>")}).join("")+"<p style=\"color: rgb(32, 33, 36); font-family: 'Google Sans', Roboto, RobotoDraft, Helvetica, Arial, sans-serif; font-size: 14px; white-space-collapse: preserve; margin: 0px;\"><br></p>"}(t);e.innerHTML=l,e.dispatchEvent(new Event("input",{bubbles:!0}))}catch(e){console.error("First fallback failed:",e);try{document.execCommand("insertText",!1,t)}catch(e){console.error("All insertion methods failed:",e)}}}}"mail.google.com"===window.location.hostname&&(document.body.setAttribute("data-page","gmail"),document.addEventListener("focusin",function(e){var t,n=e.target;if(function(e){if(!e)return!1;if("mail.google.com"===window.location.hostname&&"textbox"===e.getAttribute("role")&&e.closest('[role="dialog"]'))return console.log("Detected Gmail compose box by role and dialog"),!0;if("true"===e.getAttribute("g_editable")||"Message Body"===e.getAttribute("aria-label")||"true"===e.getAttribute("aria-multiline"))return console.log("Detected Gmail compose box by attributes"),!0;if(e.closest('div[role="textbox"], div.editable.LW-avf'))return console.log("Detected element inside Gmail compose box"),!0;if(window.location.pathname.includes("/compose")){var t,n=o(document.querySelectorAll('[contenteditable="true"]'));try{for(n.s();!(t=n.n()).done;){if(t.value.isContentEditable)return console.log("Found contenteditable in Gmail compose window"),!0}}catch(e){n.e(e)}finally{n.f()}}return!1}(n))try{!(t=n)||"mail.google.com"!==window.location.hostname||t.getAttribute("role")}catch(e){}}),"mail.google.com"===window.location.hostname&&(console.log("Setting up Gmail compose observer"),new MutationObserver(function(e){var t,n=o(e);try{for(n.s();!(t=n.n()).done;)if(t.value.addedNodes.length){document.querySelectorAll('div[role="button"]:has(g-bubble.JAPqpe), [role="button"][data-tooltip^="Send"]').forEach(function(e){if(!e.hasAttribute("data-ai-button-added")){e.setAttribute("data-ai-button-added","true");var t=e.closest('[role="dialog"]');if(t){var n=t.querySelector('div[role="textbox"]:not([aria-label="Subject"]), div.editable[contenteditable="true"]');n&&(console.log("Gmail compose observer found a match"),c(e,n))}}});var r,a=o(document.querySelectorAll('[role="dialog"] [contenteditable="true"], [role="dialog"] [role="textbox"]'));try{for(a.s();!(r=a.n()).done;){var i=r.value,l=i.closest('[role="dialog"]');if(l&&!l.hasAttribute("data-ai-processed")){var s=l.querySelector('[role="button"][data-tooltip^="Send"], [role="button"]:has(g-bubble.JAPqpe)');s&&!s.hasAttribute("data-ai-button-added")&&(l.setAttribute("data-ai-processed","true"),s.setAttribute("data-ai-button-added","true"),console.log("Gmail compose observer found a match (method 2)"),c(s,i))}}}catch(e){a.e(e)}finally{a.f()}}}catch(e){n.e(e)}finally{n.f()}}).observe(document.body,{childList:!0,subtree:!0})))})();